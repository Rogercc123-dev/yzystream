<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; font-src 'self' https://cdnjs.cloudflare.com; img-src 'self' data:;">
  <title>YZY STREAM - Kanye Wiki Scraper</title>
  
  <!-- Preload critical assets -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/ibm-plex/6.0.0/css/ibm-plex-mono.min.css" as="style">
  
  <!-- Styles -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/ibm-plex/6.0.0/css/ibm-plex-mono.min.css" rel="stylesheet" />
  
  <!-- SEO -->
  <meta name="description" content="YZY Stream Kanye Wiki Scraper - Generate clean HTML pages from Kanye West Wiki articles">
  <meta name="keywords" content="YZY, Yeezy, Kanye West, Ye, Kanye Wiki, YZY Stream, Ye Wiki">
  <meta name="author" content="YZY Stream Admin">
  <style>
    :root {
      --bg-color: #000;
      --text-color: #fff;
      --separator-color: rgba(255, 255, 255, 0.1);
      --link-color: #fff;
      --link-hover: #cccccc;
      --button-bg: #222;
      --button-border: #444;
      --button-hover: #333;
      --input-bg: #111;
      --input-border: #333;
      --error-color: #ff4d4d;
      --success-color: #4dff4d;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'IBM Plex Mono', monospace;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      padding: 1.5rem;
      max-width: 860px;
      margin: 0 auto;
      font-size: 14px;
    }
    
    .content-wrapper {
      max-width: 800px;
      margin: 0 auto;
    }
    
    header {
      margin-bottom: 2rem;
      text-align: center;
    }
    
    h1 {
      font-size: 2rem;
      font-weight: 700;
      letter-spacing: 3px;
    }
    
    h2 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      letter-spacing: 1px;
    }
    
    .separator {
      border: 0;
      height: 1px;
      background-color: var(--separator-color);
      margin: 2rem 0;
    }
    
    .card {
      background-color: var(--bg-color);
      border: 1px solid var(--separator-color);
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .form-group {
      display: flex;
      margin-bottom: 1rem;
    }
    
    input {
      flex: 1;
      padding: 0.6rem 0.8rem;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.9rem;
      border: 1px solid var(--input-border);
      background-color: var(--input-bg);
      color: var(--text-color);
      border-radius: 0;
      outline: none;
    }
    
    input:focus {
      border-color: #555;
    }
    
    button {
      padding: 0.6rem 1.2rem;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.9rem;
      border: 1px solid var(--button-border);
      background-color: var(--button-bg);
      color: var(--text-color);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    button:hover {
      background-color: var(--button-hover);
    }
    
    .example {
      font-size: 0.8rem;
      color: #888;
      margin-top: 0.5rem;
    }
    
    code {
      background-color: var(--input-bg);
      padding: 0.2rem 0.4rem;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.8rem;
      border: 1px solid var(--input-border);
    }
    
    .status {
      margin-top: 1rem;
      padding: 0.8rem;
      border: 1px solid var(--separator-color);
      transition: all 0.3s ease;
      opacity: 0;
    }
    
    .status.active {
      opacity: 1;
    }
    
    .status.loading {
      border-color: #555;
    }
    
    .status.success {
      border-color: var(--success-color);
      color: var(--success-color);
    }
    
    .status.error {
      border-color: var(--error-color);
      color: var(--error-color);
    }
    
    .spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s linear infinite;
      margin-right: 8px;
      vertical-align: middle;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .icon {
      margin-right: 8px;
      vertical-align: middle;
    }
    
    #clock {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #888;
      letter-spacing: 1px;
    }
    
    a {
      color: var(--link-color);
      text-decoration: none;
      transition: color 0.2s ease;
    }
    
    a:hover {
      color: var(--link-hover);
      text-decoration: underline;
    }
    
    .footer {
      margin-top: 2rem;
      text-align: center;
      font-size: 0.8rem;
      color: #888;
    }
    
    .footer a {
      margin: 0 0.5rem;
    }
    
    #downloadContainer {
      display: none;
      margin-top: 1.5rem;
      text-align: center;
    }
    
    #downloadBtn {
      margin-top: 1rem;
      background-color: #333;
      border-color: #555;
      padding: 0.8rem 1.5rem;
    }
    
    #downloadBtn:hover {
      background-color: #444;
    }
    
    #previewContainer {
      margin-top: 1.5rem;
      border: 1px solid var(--separator-color);
      padding: 1rem;
      max-height: 300px;
      overflow-y: auto;
      display: none;
    }
    
    #previewContainer h3 {
      margin-bottom: 1rem;
      text-align: center;
      letter-spacing: 1px;
    }
    
    .preview-content {
      font-size: 0.9rem;
      line-height: 1.5;
    }
    
    .preview-content img {
      max-width: 100%;
      height: auto;
    }
    
    .preview-content table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    
    .preview-content table th,
    .preview-content table td {
      border: 1px solid var(--separator-color);
      padding: 0.5rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>YZY STREAM</h1>
    <p>KANYE WIKI SCRAPER</p>
    <div id="clock" aria-live="polite" role="status">00:00:00 - 00/00/0000</div>
  </header>
  
  <div class="card">
    <div class="form-group">
      <input 
        id="urlInput" 
        type="text" 
        placeholder="Enter Kanye Wiki URL" 
        aria-label="Wiki URL"
      />
      <button id="generateBtn" onclick="generate()">GENERATE</button>
    </div>
    <p class="example">Example: <code>https://kanyewest.fandom.com/wiki/LOVE_EVERYONE</code></p>
    
    <div id="status" class="status"></div>
    
    <div id="downloadContainer">
      <button id="downloadBtn">DOWNLOAD HTML</button>
    </div>
  </div>
  
  <div id="previewContainer">
    <h3>PREVIEW</h3>
    <div id="previewContent" class="preview-content"></div>
  </div>
  
  <hr class="separator" />
  
  <footer class="footer">
    <p>&copy; 2025 | yzystream.com</p>
    <nav aria-label="Footer navigation">
      <a href="index.html">Home</a> | 
      <a href="untitled.html">[untitled]</a> | 
      <a href="faq.html">FAQ</a> | 
      <a href="privacy.html">Privacy Policy</a>
    </nav>
  </footer>
  
  <script>
    // Constants
    const CORS_PROXY = 'https://api.allorigins.win/get?url=';
    const STATUS_TYPES = {
      LOADING: 'loading',
      SUCCESS: 'success',
      ERROR: 'error'
    };
    
    // DOM Elements
    const urlInput = document.getElementById('urlInput');
    const generateBtn = document.getElementById('generateBtn');
    const statusEl = document.getElementById('status');
    const clockEl = document.getElementById('clock');
    const downloadContainer = document.getElementById('downloadContainer');
    const downloadBtn = document.getElementById('downloadBtn');
    const previewContainer = document.getElementById('previewContainer');
    const previewContent = document.getElementById('previewContent');
    
    // Variables to store generated content
    let generatedHTML = '';
    let pageTitle = 'YZY_PAGE';
    
    // Clock function
    function updateClock() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const year = now.getFullYear();
      
      clockEl.textContent = `${hours}:${minutes}:${seconds} - ${day}/${month}/${year}`;
    }
    
    // Initialize and update clock
    updateClock();
    setInterval(updateClock, 1000);
    
    // Utility Functions
    function updateStatus(message, type) {
      statusEl.className = `status ${type} active`;
      
      if (type === STATUS_TYPES.LOADING) {
        statusEl.innerHTML = `<span class="spinner"></span> ${message}`;
      } else if (type === STATUS_TYPES.SUCCESS) {
        statusEl.innerHTML = `<span class="icon">✓</span> ${message}`;
      } else if (type === STATUS_TYPES.ERROR) {
        statusEl.innerHTML = `<span class="icon">✗</span> ${message}`;
      }
    }
    
    function cleanContent(content) {
      // Remove scripts and SVG icons
      let cleaned = content.replaceAll(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
      cleaned = cleaned.replaceAll(/<svg\b[^<]*(?:(?!<\/svg>)<[^<]*)*<\/svg>/gi, '');
      
      // Remove edit section links and other wiki UI elements
      cleaned = cleaned.replaceAll(/<span class="mw-editsection">.*?<\/span>/gi, '');
      cleaned = cleaned.replaceAll(/<a[^>]*title="Sign in to edit"[^>]*>.*?<\/a>/gi, '');
      cleaned = cleaned.replaceAll(/\]<\/span>/gi, '');
      cleaned = cleaned.replaceAll(/<noscript>.*?<\/noscript>/gi, '');
      
      // Fix image URLs and attributes
      cleaned = cleaned.replaceAll(/src="data:image\/gif;base64[^"]*"/gi, '');
      
      // Remove Fandom specific elements
      cleaned = cleaned.replaceAll(/<!-- NewPP.*?-->/gs, '');
      cleaned = cleaned.replaceAll(/<!-- Saved in parser.*?-->/gs, '');
      
      // Remove unwanted classes and attributes
      cleaned = cleaned.replaceAll(/\stypeof="[^"]*"/gi, '');
      cleaned = cleaned.replaceAll(/\sclass="(?!wikitable|infobox)[^"]*"/gi, '');
      cleaned = cleaned.replaceAll(/\s(?:data-[^\s=]*)="[^"]*"/gi, '');
      cleaned = cleaned.replaceAll(/\sdecoding="[^"]*"/gi, '');
      cleaned = cleaned.replaceAll(/\sloading="[^"]*"/gi, '');
      
      // Fix relative URLs to absolute
      cleaned = cleaned.replaceAll(/href="\/wiki/g, 'href="https://kanyewest.fandom.com/wiki');
      cleaned = cleaned.replaceAll(/src="\/wiki/g, 'src="https://kanyewest.fandom.com/wiki');
      
      return cleaned;
    }
    
    function sanitizeFilename(str) {
      return str.replace(/[^\w\s-]/g, '')
        .replace(/\s+/g, '_')
        .toLowerCase();
    }
    
    function extractPageMetadata(doc) {
      const title = doc.querySelector('h1.page-header__title')?.innerText.trim() || 'Untitled';
      
      // Try to extract a description
      let description = '';
      const firstParagraph = doc.querySelector('.mw-parser-output > p');
      if (firstParagraph) {
        description = firstParagraph.textContent.trim().substring(0, 160);
        if (description.length === 160) description += '...';
      }
      
      return { title, description };
    }
    
    // Main Functions
    async function fetchWikiPage(url) {
      try {
        const response = await fetch(CORS_PROXY + encodeURIComponent(url));
        
        if (!response.ok) {
          throw new Error(`Failed to fetch page: ${response.status} ${response.statusText}`);
        }
        
        const data = await response.json();
        return data.contents;
      } catch (error) {
        console.error('Fetch error:', error);
        throw new Error('Failed to connect to the wiki page. Check your internet connection and try again.');
      }
    }
    
    function parseWikiContent(htmlContent) {
      const parser = new DOMParser();
      const doc = parser.parseFromString(htmlContent, 'text/html');
      
      const { title, description } = extractPageMetadata(doc);
      const content = doc.querySelector('.mw-parser-output')?.innerHTML || '';
      
      if (!content) {
        throw new Error('Could not find content on the wiki page.');
      }
      
      return { title, description, content };
    }
    
    function generateHTML(title, description, content) {
      const cleanedContent = cleanContent(content);
      
      return `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; style-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; font-src 'self' https://cdnjs.cloudflare.com; img-src * data:;">
  <title>${title} | yzystream</title>
  <meta name="description" content="${description}">
  
  <!-- Preload critical assets -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/ibm-plex/6.0.0/css/ibm-plex-mono.min.css" as="style">
  <link rel="preload" href="/style.css" as="style">
  
  <!-- Styles -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/ibm-plex/6.0.0/css/ibm-plex-mono.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  
  <style>
    :root {
      --bg-color: #000;
      --text-color: #fff;
      --separator-color: rgba(255, 255, 255, 0.1);
      --link-color: #fff;
      --link-hover: #aaa;
      --infobox-bg: #111;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'IBM Plex Mono', monospace;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      padding: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .site-logo {
      font-size: 1.5rem;
      font-weight: bold;
      letter-spacing: 2px;
      margin-bottom: 0.5rem;
    }
    
    h1 {
      font-size: 2.2rem;
      margin: 1.5rem 0;
      letter-spacing: 1px;
    }
    
    h2 {
      font-size: 1.6rem;
      margin: 1.2rem 0;
      letter-spacing: 0.5px;
    }
    
    h3 {
      font-size: 1.3rem;
      margin: 1rem 0;
    }
    
    p {
      margin-bottom: 1rem;
    }
    
    a {
      color: var(--link-color);
      text-decoration: none;
    }
    
    a:hover {
      color: var(--link-hover);
      text-decoration: underline;
    }
    
    img {
      max-width: 100%;
      height: auto;
      margin: 1rem 0;
    }
    
    .infobox {
      border: 1px solid var(--separator-color);
      background-color: var(--infobox-bg);
      padding: 1rem;
      margin-bottom: 1.5rem;
      float: right;
      max-width: 300px;
      margin-left: 1.5rem;
    }
    
    .infobox img {
      width: 100%;
      display: block;
    }
    
    .wikitable {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    
    .wikitable th,
    .wikitable td {
      border: 1px solid var(--separator-color);
      padding: 0.6rem;
    }
    
    .wikitable th {
      background-color: #111;
    }
    
    .footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.8rem;
      padding: 1rem 0;
      border-top: 1px solid var(--separator-color);
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }
      
      .infobox {
        float: none;
        max-width: 100%;
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="site-logo">YZY STREAM</div>
    <a href="/">← BACK TO HOME</a>
  </div>
  
  <article class="wiki-content">
    ${cleanedContent}
  </article>
  
  <footer class="footer">
    <p>Content sourced from Kanye West Wiki | Formatted by YZY STREAM</p>
    <p>&copy; 2025 | <a href="/">yzystream.com</a></p>
  </footer>
  
  <script>
    // Basic script to improve navigation
    document.addEventListener('DOMContentLoaded', function() {
      // Add target="_blank" to external links
      const links = document.querySelectorAll('a[href^="http"]');
      links.forEach(link => {
        if (!link.href.includes('yzystream.com')) {
          link.setAttribute('target', '_blank');
          link.setAttribute('rel', 'noopener noreferrer');
        }
      });
    });
  </script>
</body>
</html>`;
    }
    
    function downloadHTML(content, filename) {
      const blob = new Blob([content], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      
      setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }, 100);
    }
    
    // Event handlers
    async function generate() {
      // Hide preview and download container
      downloadContainer.style.display = 'none';
      previewContainer.style.display = 'none';
      
      const url = urlInput.value.trim();
      
      if (!url) {
        updateStatus('Please enter a valid Kanye Wiki URL.', STATUS_TYPES.ERROR);
        return;
      }
      
      if (!url.includes('kanyewest.fandom.com/wiki/')) {
        updateStatus('Please enter a valid Kanye Wiki URL from kanyewest.fandom.com.', STATUS_TYPES.ERROR);
        return;
      }
      
      // Start processing
      updateStatus('Fetching wiki page...', STATUS_TYPES.LOADING);
      
      try {
        // Fetch wiki page
        const htmlContent = await fetchWikiPage(url);
        
        // Parse wiki content
        updateStatus('Extracting content...', STATUS_TYPES.LOADING);
        const { title, description, content } = parseWikiContent(htmlContent);
        
        // Generate clean HTML
        updateStatus('Generating clean HTML...', STATUS_TYPES.LOADING);
        generatedHTML = generateHTML(title, description, content);
        pageTitle = sanitizeFilename(title);
        
        // Show success message
        updateStatus(`Page "${title}" successfully processed.`, STATUS_TYPES.SUCCESS);
        
        // Show download button
        downloadContainer.style.display = 'block';
        
        // Show preview
        previewContainer.style.display = 'block';
        previewContent.innerHTML = cleanContent(content);
        
      } catch (error) {
        updateStatus(error.message, STATUS_TYPES.ERROR);
      }
    }
    
    // Add event listeners
    downloadBtn.addEventListener('click', () => {
      downloadHTML(generatedHTML, `${pageTitle}.html`);
    });
    
    // Enter key functionality
    urlInput.addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
        generate();
      }
    });
    
    // Check URL parameter for auto-loading
    document.addEventListener('DOMContentLoaded', function() {
      const urlParams = new URLSearchParams(window.location.search);
      const autoUrl = urlParams.get('url');
      
      if (autoUrl) {
        urlInput.value = autoUrl;
        generate();
      }
    });
  </script>
</body>
</html>
